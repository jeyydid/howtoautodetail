<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dilution Calculator | HowToAutoDetail</title>
  <meta name="description" content="Calculate concentrate and water volumes for any 1:X dilution ratio." />
  <link rel="stylesheet" href="../../assets/styles.css" />

  <!-- Page-specific tweaks (keeps global stylesheet clean) -->
  <style>
    .tool-shell {
      padding: 1.25rem 0 2rem;
    }
    .tool-card {
      max-width: 560px;
      margin: 0 auto;
    }
    .form-grid {
      display: grid;
      gap: 0.9rem;
      margin-top: 1rem;
    }
    label {
      display: block;
      font-weight: 700;
      margin-bottom: 0.35rem;
    }
    input {
      width: 100%;
      padding: 0.65rem;
      border-radius: 10px;
      border: 1px solid var(--border);
      font-size: 1rem;
      background: #fff;
    }
    .actions {
      margin-top: 0.35rem;
      display: flex;
      gap: 0.75rem;
      flex-wrap: wrap;
    }
    .results {
      margin-top: 1rem;
      padding: 1rem;
      background: rgba(31,41,55,0.04);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      display: none;
    }
    .result-row {
      display: grid;
      grid-template-columns: 1.2fr 1fr 1fr;
      gap: 1rem;
      padding: 0.4rem 0;
      border-bottom: 1px solid rgba(229,231,235,0.8);
      align-items: center;
    }
    .result-row:last-child {
      border-bottom: none;
    }
    .result-value {
      font-weight: 900;
      text-align: right;
    }
    .result-label {
      color: var(--muted);
      font-weight: 700;
    }
    .error {
      margin-top: 0.9rem;
      color: #dc2626;
      font-weight: 700;
      display: none;
    }
    .hint {
      margin: 0.35rem 0 0;
      color: var(--muted);
      font-size: 0.95rem;
      line-height: 1.45;
    }
  </style>
</head>

<body>
  <a class="skip-link" href="#main">Skip to content</a>

  <header class="site-header">
    <div class="wrap header-inner">
      <a href="https://jeyydid.github.io/howtoautodetail/" class="brand" aria-label="HowToAutoDetail homepage">
        <div class="brand-mark" aria-hidden="true">H</div>
        <div class="brand-text">
          <div class="brand-title">HowToAutoDetail</div>
          <div class="brand-subtitle">Tool Suite</div>
        </div>
      </a>

      <nav class="top-nav" aria-label="Primary">
        <a class="nav-link" href="index.html" aria-current="page">Home</a>
        <a class="nav-link" href="https://howtoautodetail.com/" rel="noopener noreferrer">HTAD Wiki</a>
      </nav>
    </div>
  </header>

  <main id="main" class="wrap">
    <section class="tool-shell">
      <div class="section-head">
        <div>
          <h1 style="margin:0; font-size:1.6rem;">Dilution Calculator</h1>
          <p class="muted" style="margin:.35rem 0 0;">
            Works out the concentrate and water needed for any <strong>1:X</strong> ratio.
          </p>
        </div>
      </div>

      <article class="card tool-card">
        <div class="card-body">
          <div class="card-kicker">Calculator</div>

          <p class="hint">
            Example: <strong>1:100</strong> and <strong>2500 ml</strong> → tells you how many ml of concentrate to use.
          </p>

          <div class="form-grid" role="form" aria-label="Dilution calculator inputs">
            <div>
              <label for="ratio">Dilution Ratio (e.g. 1:100)</label>
              <input type="text" id="ratio" placeholder="1:100" autocomplete="off" inputmode="text" />
            </div>

            <div>
              <label for="finalVolume">Final Volume (ml)</label>
              <input type="number" id="finalVolume" placeholder="2500" min="1" inputmode="numeric" />
            </div>

            <div class="actions">
              <button class="btn btn-primary" type="button" onclick="calculateDilution()">Calculate</button>
              <a class="btn btn-ghost" href="../../">Back to home</a>
            </div>

            <div class="error" id="error" aria-live="polite"></div>

            <div class="results" id="results" aria-live="polite">
              <div class="result-row" style="font-weight:800;">
                <div></div>
                <div>Ratio</div>
                <div>Factor</div>
              </div>

              <div class="result-row">
                <div class="result-label">Concentrate</div>
                <div class="result-value"><span id="concentrate_ratio"></span> ml</div>
                <div class="result-value"><span id="concentrate_factor"></span> ml</div>
              </div>

              <div class="result-row">
                <div class="result-label">Water</div>
                <div class="result-value"><span id="water_ratio"></span> ml</div>
                <div class="result-value"><span id="water_factor"></span> ml</div>
              </div>
            </div>

        <div class="card-footer">
          <span class="pill">No tracking • Offline-friendly</span>
        </div>
      </article>
    </section>
  </main>

  <footer class="site-footer">
    <div class="wrap footer-inner">
      <div class="footer-left">
        <span>© 2026 jeyydid – HowToAutoDetail</span>
      </div>
      <div class="footer-right">
        <a class="nav-link" href="#main">Back to top</a>
      </div>
    </div>
  </footer>

  <script>
    // Number formatter for inputs and outputs
    const formatter = new Intl.NumberFormat("en-GB", {
      minimumFractionDigits: 0,
      maximumFractionDigits: 2
    });

    function formatNumber(value) {
      return formatter.format(value);
    }

    function parseNumber(value) {
      return parseFloat(value.replace(/,/g, ""));
    }

    // Calculator
    function calculateDilution() {
      const ratioInput = document.getElementById("ratio").value.trim();
      const finalVolume = parseNumber(document.getElementById("finalVolume").value);

      const errorEl = document.getElementById("error");
      const resultsEl = document.getElementById("results");

      errorEl.style.display = "none";
      resultsEl.style.display = "none";

      if (!ratioInput.includes(":") || isNaN(finalVolume) || finalVolume <= 0) {
        showError("Please enter a valid ratio (e.g. 1:100) and volume.");
        return;
      }

      const parts = ratioInput.split(":");

      if (parts.length !== 2) {
        showError("Invalid ratio format. Use format 1:100.");
        return;
      }

      const partA = parseFloat(parts[0]);
      const partB = parseFloat(parts[1]);

      if (isNaN(partA) || isNaN(partB) || partA <= 0 || partB <= 0) {
        showError("Ratio must contain positive numbers.");
        return;
      }

      // Ratio method
      const totalParts = partA + partB;
      const concentrate = (partA / totalParts) * finalVolume;
      const water = finalVolume - concentrate;

      // Factor method
      const factorConcentrate = finalVolume / partB;
      const factorWater = finalVolume - factorConcentrate;

      // Populate Ratio column
      document.getElementById("concentrate_ratio").textContent =
        formatNumber(concentrate.toFixed(2));

      document.getElementById("water_ratio").textContent =
        formatNumber(water.toFixed(2));

      // Populate Factor column
      document.getElementById("concentrate_factor").textContent =
        formatNumber(Math.round(factorConcentrate));

      document.getElementById("water_factor").textContent =
        formatNumber(Math.round(factorWater));

      resultsEl.style.display = "block";
    }

    function showError(message) {
      const errorEl = document.getElementById("error");
      errorEl.textContent = message;
      errorEl.style.display = "block";
    }

    document.getElementById("finalVolume").addEventListener("input", function(e) {
      const value = e.target.value.replace(/,/g, "");
      if (!isNaN(value) && value !== "") {
        e.target.value = formatNumber(value);
      }
    });
  </script>
</body>
</html>
